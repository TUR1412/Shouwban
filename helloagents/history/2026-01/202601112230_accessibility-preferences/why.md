# 变更提案: 无障碍与偏好中心（A11y Preferences）

## 需求背景
站点已具备「未来感 UI + 多主题 + 丰富动效」的体验，但缺少用户可控的“无障碍/可读性”偏好入口。
这会让部分用户在以下场景下体验不佳：
- 对动效敏感（晕动、注意力负担），需要显式减少动效
- 需要更高对比度来提升可读性
- 需要放大字体以适配不同设备与阅读距离

本变更在不改变站点核心架构（纯静态站点、无运行时第三方依赖、按页模块加载）的前提下，补齐用户级偏好中心，并与系统偏好协同。

## 变更内容
1. 新增 Accessibility 模块：本地持久化 `a11y` 偏好，并映射为：
   - `html[data-motion="reduce"]`（减少动效）
   - `html[data-contrast="high"]`（高对比）
   - `--a11y-font-scale`（字体缩放）
2. 会员中心新增「无障碍与偏好」卡片：减少动效 / 高对比模式 / 字体缩放（100%~125%）。
3. 动效层尊重偏好：`Motion.animate()` 自动尊重用户偏好与 `prefers-reduced-motion`。
4. PWA/工具链同步：SW 预缓存、版本号 bump、结构校验与语法检查覆盖新增模块。

## 影响范围
- **模块**：Runtime / UI / PWA / Tooling / Tests
- **存储键**：新增 `a11y`（对象结构）
- **页面**：`account.html` 新增偏好面板

## 核心场景

### 需求: 用户级无障碍偏好
**模块:** UI / Runtime

#### 场景: 减少动效
前置条件：用户进入 `account.html` 并开启「减少动效」。
- 预期结果 1：页面动效降级（`Motion.animate()` 变为零时长）。
- 预期结果 2：偏好写入本机存储，刷新页面后仍生效。

#### 场景: 高对比模式
前置条件：用户开启「高对比模式」。
- 预期结果：玻璃容器与边框对比度提升，`focus-visible` 外框更清晰。

#### 场景: 字体缩放
前置条件：用户调整字体缩放滑杆到 110% 或 125%。
- 预期结果：全站基于 rem 的字阶随缩放同步变化；范围受控，不破坏布局。
- 预期结果：偏好写入本机存储并可跨标签页同步刷新。

## 风险评估
- **风险：** 全局 `html` 字体缩放可能影响布局稳定性。
  - **缓解：** 限制在 100%~125%，并保持 rem 体系一致。
- **风险：** 新增运行时模块可能导致离线缺失。
  - **缓解：** `sw.js` precache + `scripts/validate.mjs` 守护 + `bump-version` 版本同步。

