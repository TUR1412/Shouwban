---
description: 
globs: 
alwaysApply: true
---
# 手办销售网站前端 - 项目开发指南与规则 (v1.1)

## 项目概述
本项目旨在创建并交付一个功能完善、视觉精美、响应式、用户体验流畅的手办在线销售网站的前端部分。AI (Gemini) 负责全部前端实现，用户 (天帝) 提供素材与 API。

## 主要文件和目录 (项目结构)
*   **入口文件**: `index.html`
*   **其他 HTML**: `products.html`, `category.html`, `product-detail.html`, `cart.html`, `checkout.html`, `static-page.html` (文件名即路由)
*   **样式表**: `styles/main.css` (存放所有 CSS)
*   **脚本文件**: `scripts/main.js` (存放所有 JavaScript, 应采用模块化组织)
*   **资源目录**: `assets/` (images, fonts, videos)
*   **项目文档**: `README.md`, `项目方案书-手办落地页.md` (v2.0 详细版，是具体执行蓝图)
*   **本规则文件**: `.cursor/rules/project-structure.mdc`

## 开发规则与规范 (重点强化)

**1. HTML 规范:**
    *   **语义化:** 严格使用 HTML5 语义化标签 (`<header>`, `<footer>`, `<nav>`, `<main>`, `<section>`, `<article>`, `<aside>` 等)。
    *   **结构清晰:** 保持良好的缩进和嵌套结构。
    *   **可访问性基础:**
        *   所有 `<img>` 必须有描述性的 `alt` 属性，占位符图片 `alt` 应为 `[描述性占位符文本]`。
        *   所有表单元素 (`<input>`, `<select>`, `<textarea>`, `<button>`) 必须有关联的 `<label>` 或设置 `aria-label` / `aria-labelledby`。
        *   交互元素（链接、按钮）应有清晰可辨的文本或 `aria-label`。

**2. CSS 规范 (`styles/main.css`):**
    *   **BEM 命名:** 严格遵循 BEM (`block__element--modifier`) 命名约定，提高可读性和可维护性。
    *   **CSS 变量:** 必须使用 CSS 变量 (`--var-name`) 统一定义全局颜色、字体、主要间距等，方便主题管理和修改。
    *   **模块化:** 样式应按组件或页面区域组织注释，例如 `/* Header styles */`, `/* Product Card */`。
    *   **响应式设计:**
        *   **移动优先 (Mobile-First):** 必须采用移动优先的策略编写 CSS。
        *   **断点:** 定义并使用统一的响应式断点 (例如 `sm`, `md`, `lg`, `xl`) 进行媒体查询 `@media (min-width: ...)`。
        *   **布局技术:** 优先使用 Flexbox 和 Grid 进行布局。
        *   **单位:** 优先使用相对单位 (`rem`, `em`, `%`, `vw`, `vh`)，像素 (`px`) 用于边框或固定小尺寸。
    *   **避免 `!important`:** 除非极特殊情况，禁止使用 `!important`。
    *   **浏览器前缀:** 必要时添加浏览器兼容性前缀 (可考虑后期使用 Autoprefixer 工具)。

**3. JavaScript 规范 (`scripts/main.js`):**
    *   **模块化:**
        *   必须采用模块化方式组织代码，避免全局变量污染。可以使用 IIFE (立即调用函数表达式) 或简单的对象字面量来创建命名空间/模块。
        *   例如: `const Header = (function() { ... })();`, `const Cart = { init: function() {...}, update: function() {...} };`
    *   **ES6+ 语法:** 使用现代 JavaScript 语法 (let/const, 箭头函数, 模板字符串等)。
    *   **代码清晰:** 函数和变量命名清晰表意，添加必要的注释解释复杂逻辑。
    *   **DOM 操作:**
        *   缓存 DOM 查询结果，避免重复查询。
        *   尽量减少直接的 DOM 操作次数，必要时使用 `DocumentFragment`。
    *   **事件处理:**
        *   优先使用事件委托 (`addEventListener` 在父元素上) 处理列表项等动态或大量元素的事件。
        *   对 `scroll`, `resize` 等频繁触发的事件，必须使用节流 (throttle) 或防抖 (debounce) 技术优化性能。
    *   **前端状态模拟 (API 集成前):**
        *   购物车、用户偏好等需要跨页面保持的状态，必须使用 `LocalStorage` 或 `SessionStorage` 进行模拟存储。
        *   状态更新逻辑必须封装在特定模块中 (如 `Cart` 模块)，确保数据一致性。
    *   **交互反馈:** 所有用户操作（点击按钮、表单提交等）必须提供即时的视觉反馈（如按钮禁用、加载状态、成功/错误消息）。

**4. 组件化思维与实现:**
    *   **识别可复用块:** 必须识别并一致地实现项目中的可复用 UI 块 (如 Header, Footer, ProductCard, CartItem, QuantitySelector, Modal, Breadcrumb)。
    *   **HTML 结构一致:** 同一组件在不同地方使用时，其核心 HTML 结构应保持一致。
    *   **CSS 封装:** 组件的 CSS 样式应尽可能封装在其 BEM 块下。
    *   **JS 逻辑关联:** 组件相关的 JS 交互逻辑应封装在对应的 JS 模块或函数中。

**5. 可访问性 (A11y) 进阶要求:**
    *   **键盘导航:** 所有交互式元素（链接、按钮、表单控件、自定义下拉菜单、Tab 等）必须可以通过键盘 (`Tab`, `Shift+Tab`, `Enter`, `Space`, 方向键) 进行导航和操作。
    *   **焦点管理:**
        *   焦点指示器 (`:focus` / `:focus-visible` 样式) 必须始终可见且清晰。
        *   打开模态框或菜单时，焦点应自动移入其中；关闭时，焦点应合理地返回触发元素。
    *   **ARIA 属性:**
        *   在需要时正确使用 ARIA role (e.g., `role="dialog"`, `role="menu"`, `role="tablist"`) 和 state/property (e.g., `aria-expanded`, `aria-selected`, `aria-hidden`, `aria-invalid`) 来增强自定义组件的语义和可访问性。
        *   对于动态加载或更新的内容区域，考虑使用 `aria-live` 区域让屏幕阅读器能够播报变化。

**6. 性能优化规则:**
    *   **图片:** 严格执行懒加载 (`loading="lazy"` 属性或使用 Intersection Observer 实现)。提供 WebP 等现代格式选项 (如果可行)。确保图片在使用前被适当压缩。
    *   **代码:** 减少和优化 DOM 操作。使用节流/防抖处理高频事件。
    *   **(未来) 构建:** 考虑部署前对 CSS 和 JS 进行压缩 (Minification)。

**7. 测试要求:**
    *   **开发中自测:** 每个功能或组件完成后，开发者必须进行基本的手动测试。
    *   **交付前测试清单 (必须执行):**
        *   **核心功能:**
            *   导航链接跳转正确。
            *   分类下拉/移动菜单正常工作。
            *   搜索框正常切换。
            *   商品卡片链接到详情页。
            *   详情页图片库切换/放大(若有)正常。
            *   数量选择器正常工作 (加减、边界值)。
            *   加入购物车功能正常 (状态模拟、数量更新)。
            *   购物车页面：商品增删改查正常，总价计算正确，空状态显示正常。
            *   结算页面：表单基本验证有效，支付方式可选。
            *   静态页面内容根据 URL 参数加载正确。
        *   **响应式布局:**
            *   在至少 3 个关键断点 (如 375px, 768px, 1200px) 下检查所有页面的布局是否合理，无元素重叠或溢出。
        *   **浏览器兼容性:**
            *   在最新版本的 Chrome, Firefox, Edge (或 Safari, 如果环境允许) 下检查核心功能和布局。
        *   **可访问性基础:**
            *   尝试仅使用键盘导航和操作主要功能。
            *   检查焦点指示器是否全程可见。
            *   使用浏览器开发者工具检查 ARIA 属性的基本应用。

**8. AI 职责与主动性:**
    *   AI 必须主动、完整地实现 `项目方案书-手办落地页.md` (v2.0 详细版) 中描述的所有前端功能和交互细节。
    *   AI 应严格遵守本规则文件中的所有规范。
    *   在遇到模糊不清或潜在问题时，AI 应主动提出并寻求天帝确认，而不是交付不确定或半成品的功能。
    *   目标是交付一个可以直接进行素材替换和 API 集成的、高质量的前端代码库。

## 开发计划 (参考 `项目方案书` v2.0 第 7 节)
(此处的计划为通用流程，具体执行细节参考方案书)
1.  需求分析与设计 (已完成，产出方案书 v2.0)
2.  前端开发 (进行中，遵循上述规范和方案书细节)
3.  测试 (开发各阶段持续进行，交付前执行完整测试清单)
4.  交付与准备集成

## 潜在问题及预防措施 (参考 `项目方案书` v2.0 第 8 节)
(主要关注前端相关风险)
*   交互逻辑复杂性 -> 沟通、分阶段
*   性能瓶颈 -> 持续优化、工具检测
*   浏览器兼容性 -> 现代浏览器优先、测试
*   可访问性不足 -> 遵循规范、测试工具

---
请严格按照本指南和 `项目方案书-手办落地页.md` (v2.0) 进行开发。





